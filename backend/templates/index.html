<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Generator Orar</title>
</head>
<body>
    <h1>Generează un Orar</h1>

    <textarea id="reguli" rows="10" cols="80">
        Generează un orar pentru o săptămână pentru studenți, structurat pe ani de studiu, respectând următoarele reguli:
        - Programul zilnic pentru studenții de la licență va fi între 08:00-20:00, iar pentru cei de la master între 16:00-20:00.
        - Pentru fiecare zi, generează orar pentru TOATE cele 4 ANI de studiu de la licență (Anul I, II, III, IV) și TOATE anii de la master (ex: Anul I, II). Toți anii trebuie să fie incluși, chiar dacă unii nu au activități.
        - Fiecare zi trebuie să aibă minim 4 ore și maxim 8 ore de activitate.
        - Nu include pauze între activități.
        - Folosește denumiri reale de discipline pentru fiecare an de studiu, la care sa scrii daca este curs/laborator/seminar.
        - Activitățile trebuie să fie distribuite uniform pe parcursul săptămânii.
        - Nu repeta activitățile în aceeași săptămână.
        - Activitățile pentru studenții de la licență vor fi diferite de cele pentru studenții de la master.
        - Structura: cursuri la nivel de an, seminare la nivel de grupă, laboratoare la nivel de subgrupă.
        - Ziua de miercuri la ora 14:00 trebuie să fie liberă.
        - Răspunde doar cu un JSON curat, fără explicații, cu structura: { "Licenta": { "Anul I": { "Luni": { interval: activitate }, ... } }, "Master": {...} }
    </textarea>

    <br><br>
    <button onclick="trimiteReguli()">Generează Orarul</button>

    <h2>Rezultat:</h2>
    <pre id="rezultat"></pre>

    <script>
        function trimiteReguli() {
            const reguli = document.getElementById("reguli").value;

            fetch("/genereaza_orar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ reguli })
            })
            .then(response => response.text())  // preluăm răspunsul ca text
            .then(text => {
                console.log("Răspuns brut:", text);
                try {
                    const data = JSON.parse(text);  // încercăm parsarea JSON
                    document.getElementById("rezultat").textContent = JSON.stringify(data, null, 2);
                } catch (e) {
                    document.getElementById("rezultat").textContent = "Eroare la parsare JSON:\n\n" + text;
                }
            })
            .catch(error => {
                document.getElementById("rezultat").textContent = "Eroare: " + error;
            });
        }
    </script>
</body>
</html>
